import{c as f,r as t,u as k,b as _,t as o,j as e,e as E}from"./index-Bmo1lgvl.js";import{C as p}from"./circle-alert-DEfECA1e.js";/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],R=f("chevron-down",S);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],F=f("chevron-up",D);function T(){const[m,j]=t.useState([]),[y,x]=t.useState(!0),[n,N]=t.useState(null),[u,l]=t.useState(null),[d,c]=t.useState(""),[i,b]=t.useState(!1),g=k();t.useEffect(()=>{h()},[]);const h=async()=>{try{x(!0);const s=(await _()).sort((a,C)=>new Date(C.criado_em||"").getTime()-new Date(a.criado_em||"").getTime());j(s)}catch(r){o.error("Erro ao carregar pedidos"),console.error(r)}finally{x(!1)}},v=async r=>{var s;if(!d.trim()){o.error("Preencha o campo");return}try{b(!0),await E(r,d),o.success("Problema relatado com sucesso!"),l(null),c(""),await h()}catch(a){o.error(((s=a==null?void 0:a.data)==null?void 0:s.erro)||"Erro ao relatar problema"),console.error(a)}finally{b(!1)}},w=r=>({pendente:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",preparando:"bg-blue-500/10 text-blue-500 border-blue-500/20",pronto:"bg-green-500/10 text-green-500 border-green-500/20",entregue:"bg-gray-500/10 text-gray-500 border-gray-500/20"})[r]||"bg-gray-500/10 text-gray-500 border-gray-500/20",P=r=>({pendente:"Pendente",preparando:"Em Preparo",pronto:"Pronto",entregue:"Entregue"})[r]||r;return y?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando pedidos..."})]})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Meus Pedidos"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Acompanhe o status dos seus pedidos"})]}),e.jsx("button",{onClick:()=>g("/"),className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Voltar ao CardÃ¡pio"})]}),m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground text-lg",children:"Nenhum pedido encontrado"}),e.jsx("button",{onClick:()=>g("/"),className:"mt-4 px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Fazer Pedido"})]}):e.jsx("div",{className:"space-y-4",children:m.map(r=>e.jsxs("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Pedido #",r.id]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${w(r.status)}`,children:P(r.status)})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["Cliente: ",r.nome_cliente]}),e.jsxs("p",{children:["Mesa: ",r.mesa]}),e.jsxs("p",{children:["Total: R$ ",parseFloat(r.total).toFixed(2)]}),r.criado_em&&e.jsxs("p",{children:["Data: ",new Date(r.criado_em).toLocaleString("pt-BR")]})]})]}),e.jsx("button",{onClick:()=>N(n===r.id?null:r.id),className:"p-2 hover:bg-primary/10 rounded-lg transition-colors",children:n===r.id?e.jsx(F,{className:"w-5 h-5 text-foreground"}):e.jsx(R,{className:"w-5 h-5 text-foreground"})})]}),n===r.id&&e.jsxs("div",{className:"border-t border-border p-4 bg-background/50",children:[r.itens&&r.itens.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-foreground mb-2",children:"Itens do Pedido:"}),e.jsx("div",{className:"space-y-2",children:r.itens.map((s,a)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.quantidade,"x ",s.nome_item||`Item #${s.item_menu}`,s.observacao&&e.jsxs("span",{className:"text-xs italic",children:[" (",s.observacao,")"]})]}),e.jsxs("span",{className:"text-foreground font-medium",children:["R$ ",parseFloat(s.preco_item).toFixed(2)]})]},a))})]}),r.problema&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-yellow-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Problema Relatado:"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r.problema})]})]})}),!r.problema&&u!==r.id&&e.jsxs("button",{onClick:()=>l(r.id),className:"w-full py-2 bg-yellow-500/10 hover:bg-yellow-500/20 text-yellow-600 border border-yellow-500/20 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(p,{className:"w-4 h-4"}),"Relatar Problema"]}),u===r.id&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Descreva o problema:"}),e.jsx("textarea",{value:d,onChange:s=>c(s.target.value),placeholder:"Digite aqui o problema com seu pedido...",rows:4,className:"w-full px-3 py-2 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:border-primary resize-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{l(null),c("")},disabled:i,className:"flex-1 px-4 py-2 bg-background border border-border text-foreground rounded-lg hover:bg-background/80 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:()=>v(r.id),disabled:i,className:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors disabled:opacity-50",children:i?"Enviando...":"Enviar Problema"})]})]})]})]},r.id))})]})})}export{T as default};
